<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide Complet Madagascar PWA</title>
    <link rel="manifest" href="manifest-guide.json">
    <meta name="theme-color" content="#007E3A">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-guide-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-guide-512.png">
    <style>:root { --rouge-mada: #FC3D32; --vert-mada: #007E3A; --blanc-mada: #FFFFFF; --beige-mada: #F5E6D3; --terre-mada: #8B4513; --ocean-mada: #0077BE; --sable: #F4D7B0; --baobab: #A0522D; --vanille: #F3E5AB; --ravinala: #228B22; }
body { font-family: 'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background: linear-gradient(135deg,var(--sable) 0%, var(--beige-mada) 50%, var(--vanille) 100%); background-attachment: fixed; min-height: 100vh; padding: 20px; transition: all 0.3s; }
body.dark-mode { background: linear-gradient(135deg, #2C1810 0%, #1a1a1a 50%, #0d0d0d 100%);}
#dark-mode-toggle {position:fixed;top:16px;left:16px;z-index:10100;border-radius:16px;background:#f5e6d3;border:none;padding:8px 18px;font-weight:bold;font-size:16px;box-shadow:0 2px 10px #0002;cursor:pointer;}
.connection-status { position: fixed; top: 10px; right: 10px; padding: 8px 16px; border-radius: 20px; font-size: 0.85em; font-weight: bold; z-index:10000; display:flex; align-items:center; gap:8px; backdrop-filter:blur(10px); box-shadow:0 4px 12px #0002; transition:all 0.3s; }
.connection-status.online {background:rgba(34,139,34,0.95);color:white;}
.connection-status.offline {background:rgba(255,140,0,0.95);color:white;}
.connection-status .pulse {width:10px;height:10px;border-radius:50%;background:currentColor;animation:pulse 2s infinite;}
@keyframes pulse {0%,100%{opacity:1;}50%{opacity:0.5;}}
</style>
</head>
<body>
<button id='dark-mode-toggle' aria-label='Mode nuit/jour'>🌞/🌙</button>
<div id='connection-status' class='connection-status online'></div>
<div class='guide-content'>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide Complet Madagascar 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 550px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #11998e;
            margin-bottom: 8px;
            font-size: 24px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            margin-bottom: 20px;
            padding-bottom: 5px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 10px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            white-space: nowrap;
            font-size: 14px;
            transition: all 0.3s;
            color: #666;
            font-weight: 500;
        }

        .tab.active {
            background: #11998e;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .search-box {
            position: relative;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #11998e;
            box-shadow: 0 0 0 3px rgba(17, 153, 142, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
            font-size: 18px;
        }

        .categories {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            margin-bottom: 20px;
            padding-bottom: 5px;
        }

        .category-btn {
            padding: 8px 16px;
            background: #f5f5f5;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            white-space: nowrap;
            font-size: 14px;
            transition: all 0.3s;
            color: #666;
        }

        .category-btn.active {
            background: #11998e;
            color: white;
            border-color: #11998e;
        }

        .price-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .price-category {
            margin-bottom: 25px;
        }

        .category-title {
            font-size: 18px;
            color: #11998e;
            margin-bottom: 12px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 8px;
            transition: all 0.2s;
        }

        .price-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .item-name {
            flex: 1;
            color: #333;
            font-size: 15px;
        }

        .item-price {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 3px;
        }

        .price-ariary {
            font-weight: 600;
            color: #11998e;
            font-size: 16px;
        }

        .price-euro {
            font-size: 12px;
            color: #666;
        }

        .tip-badge {
            background: #ffc107;
            color: #000;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .warning-badge {
            background: #f44336;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }

        .checklist {
            max-height: 500px;
            overflow-y: auto;
        }

        .checklist-section {
            margin-bottom: 25px;
        }

        .checklist-section h3 {
            font-size: 18px;
            color: #11998e;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }

        .checklist-item label {
            flex: 1;
            cursor: pointer;
            color: #333;
            font-size: 15px;
        }

        .checklist-item.checked label {
            text-decoration: line-through;
            color: #999;
        }

        .advice-box {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .advice-box h3 {
            font-size: 16px;
            margin-bottom: 10px;
        }

        .advice-box ul {
            list-style: none;
            padding-left: 0;
        }

        .advice-box li {
            font-size: 13px;
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .advice-box li:before {
            content: "💡";
            position: absolute;
            left: 0;
        }

        .legend {
            background: #fff3cd;
            padding: 12px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 12px;
            color: #856404;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 22px;
            }

            .tab {
                padding: 8px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🇲🇬 Guide Complet Madagascar</h1>
        <p class="subtitle">Prix 2025 & Liste Indispensables</p>
        
        <div class="legend" id="exchangeRateInfo" style="margin-bottom: 15px; background: #e3f2fd; color: #1565c0; border-left: 4px solid #2196f3; display: flex; justify-content: space-between; align-items: center;">
            <div>
                <strong>💱 Taux de change :</strong> <span id="rateDisplay">Chargement...</span>
            </div>
            <button onclick="fetchExchangeRate()" style="background: #2196f3; color: white; border: none; padding: 5px 12px; border-radius: 6px; cursor: pointer; font-size: 12px;">🔄</button>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="prices">💰 Prix</button>
            <button class="tab" data-tab="checklist">✈️ À Emporter</button>
        </div>

        <!-- ONGLET PRIX -->
        <div class="tab-content active" id="prices">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Rechercher un produit...">
                <span class="search-icon">🔍</span>
            </div>

            <div class="categories">
                <button class="category-btn active" data-category="all">Tout</button>
                <button class="category-btn" data-category="restaurant">🍽️ Restaurant</button>
                <button class="category-btn" data-category="street">🥘 Street Food</button>
                <button class="category-btn" data-category="marche">🛒 Marché</button>
                <button class="category-btn" data-category="transport">🚕 Transport</button>
                <button class="category-btn" data-category="boissons">🥤 Boissons</button>
                <button class="category-btn" data-category="vetements">👕 Vêtements</button>
            </div>

            <div class="price-list" id="priceList"></div>

            <div class="advice-box">
                <h3>💡 Conseils Anti-Arnaque</h3>
                <ul>
                    <li>Demandez toujours le prix AVANT d'acheter</li>
                    <li>Les prix au marché sont négociables</li>
                    <li>Prix touristique = 2-3x le prix local</li>
                    <li>Observez ce que paient les locaux</li>
                    <li>Ayez toujours de la petite monnaie</li>
                </ul>
            </div>

            <div class="legend">
                <strong>Légende :</strong> 
                <span class="tip-badge" style="margin: 0 5px;">BON PLAN</span> = Prix avantageux
                <span class="warning-badge" style="margin: 0 5px;">ARNAQUE</span> = Prix trop élevé
            </div>
        </div>

        <!-- ONGLET CHECKLIST -->
        <div class="tab-content" id="checklist">
            <div class="checklist" id="checklistContent"></div>
            
            <div class="advice-box">
                <h3>📌 Conseils Bagages</h3>
                <ul>
                    <li>Privilégiez un sac à dos pour les déplacements</li>
                    <li>Vêtements légers + 1 pull pour les soirées fraîches</li>
                    <li>La saison des pluies : octobre à mars</li>
                    <li>Saison sèche et fraîche : avril à octobre</li>
                    <li>Photocopiez tous vos documents importants</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let EURO_RATE = 5192; // Taux de secours (Octobre 2025)
        let lastUpdateTime = null;

        const pricesData = {
            restaurant: [
                { name: 'Repas local basique', ariary: 3000, tip: 'BON PLAN' },
                { name: 'Repas restaurant moyen', ariary: 15000, tip: null },
                { name: 'Repas restaurant chic', ariary: 25000, tip: null },
                { name: 'Fast-food (type McDo)', ariary: 20000, tip: null },
                { name: 'Ravitoto sy henakisoa (plat typique)', ariary: 5000, tip: 'BON PLAN' },
                { name: 'Romazava (ragoût local)', ariary: 8000, tip: 'BON PLAN' },
                { name: 'Menu pour 2 (restaurant moyen)', ariary: 70000, tip: null },
                { name: 'Pizza restaurant', ariary: 18000, tip: null }
            ],
            street: [
                { name: 'Mofo gasy (gâteau de riz)', ariary: 500, tip: 'BON PLAN' },
                { name: 'Koba (gâteau cacahuète/banane)', ariary: 2000, tip: 'BON PLAN' },
                { name: 'Mofo anana (beignet aux légumes)', ariary: 500, tip: 'BON PLAN' },
                { name: 'Sambosa (samoussa)', ariary: 1000, tip: 'BON PLAN' },
                { name: 'Nem (rouleau de printemps)', ariary: 1000, tip: 'BON PLAN' },
                { name: 'Brochette de viande (masikita)', ariary: 2000, tip: 'BON PLAN' },
                { name: 'Mofo akondro (beignet banane)', ariary: 500, tip: 'BON PLAN' },
                { name: 'Menakely (beignet sucré)', ariary: 500, tip: 'BON PLAN' },
                { name: 'Composé (assiette complète)', ariary: 8000, tip: 'BON PLAN' },
                { name: 'Jus de fruits frais (verre)', ariary: 2000, tip: 'BON PLAN' }
            ],
            marche: [
                { name: 'Riz (1 kg)', ariary: 3000, tip: 'BON PLAN' },
                { name: 'Tomates (1 kg)', ariary: 3000, tip: null },
                { name: 'Bananes (1 kg)', ariary: 2500, tip: 'BON PLAN' },
                { name: 'Oignons (1 kg)', ariary: 3200, tip: null },
                { name: 'Poulet entier', ariary: 15000, tip: 'BON PLAN' },
                { name: 'Viande de bœuf (1 kg)', ariary: 19000, tip: null },
                { name: 'Œufs (12 pièces)', ariary: 8000, tip: null },
                { name: 'Pain frais (500g)', ariary: 4000, tip: null },
                { name: 'Lait (1 litre)', ariary: 4000, tip: null },
                { name: 'Fromage local (1 kg)', ariary: 35000, tip: null },
                { name: 'Pommes de terre (1 kg)', ariary: 2500, tip: 'BON PLAN' }
            ],
            transport: [
                { name: 'Taxi-be en ville', ariary: 500, tip: 'BON PLAN' },
                { name: 'Taxi course courte (Tana)', ariary: 10000, tip: null },
                { name: 'Taxi aéroport → centre-ville', ariary: 40000, tip: 'ARNAQUE' },
                { name: 'Taxi aéroport (prix normal)', ariary: 25000, tip: 'BON PLAN' },
                { name: 'Pousse-pousse (courte distance)', ariary: 2000, tip: 'BON PLAN' },
                { name: 'Location voiture + chauffeur (jour)', ariary: 200000, tip: null },
                { name: 'Essence (1 litre)', ariary: 5000, tip: null }
            ],
            boissons: [
                { name: 'Eau minérale (1.5L)', ariary: 2500, tip: 'BON PLAN' },
                { name: 'Coca-Cola (33cl)', ariary: 3750, tip: null },
                { name: 'Bière locale (33cl)', ariary: 4000, tip: 'BON PLAN' },
                { name: 'Bière Three Horses Beer (THB)', ariary: 4500, tip: 'BON PLAN' },
                { name: 'Jus de fruits frais (1 verre)', ariary: 2000, tip: 'BON PLAN' },
                { name: 'Café / Thé local', ariary: 2000, tip: null },
                { name: 'Cappuccino (café moderne)', ariary: 5000, tip: null },
                { name: 'Cocktail en bar', ariary: 15000, tip: null }
            ],
            vetements: [
                { name: 'T-shirt marché local', ariary: 10000, tip: 'BON PLAN' },
                { name: 'T-shirt boutique', ariary: 25000, tip: null },
                { name: 'Jean marché (friperie)', ariary: 20000, tip: 'BON PLAN' },
                { name: 'Jean boutique neuf', ariary: 150000, tip: null },
                { name: 'Robe locale', ariary: 30000, tip: 'BON PLAN' },
                { name: 'Sandales/Tongs marché', ariary: 8000, tip: 'BON PLAN' },
                { name: 'Chaussures de sport (Nike/Adidas)', ariary: 250000, tip: null },
                { name: 'Chaussures locales', ariary: 40000, tip: 'BON PLAN' },
                { name: 'Chapeau de paille local', ariary: 5000, tip: 'BON PLAN' },
                { name: 'Lamba (vêtement traditionnel)', ariary: 20000, tip: 'BON PLAN' },
                { name: 'Short/Bermuda marché', ariary: 15000, tip: 'BON PLAN' },
                { name: 'Pull/Gilet', ariary: 35000, tip: null }
            ]
        };

        const checklistData = {
            documents: [
                'Passeport (validité 6 mois)',
                'Visa Madagascar (à l\'arrivée)',
                'Billet d\'avion (copie papier + numérique)',
                'Assurance voyage',
                'Photocopies passeport et documents',
                'Carnet de vaccination',
                'Carte de groupe sanguin',
                'Photos d\'identité (2)'
            ],
            sante: [
                'Anti-paludique (traitement préventif)',
                'Anti-moustique (spray DEET 50%)',
                'Crème solaire (indice 50+)',
                'Traitement anti-diarrhée',
                'Paracétamol / Ibuprofène',
                'Antiseptique et pansements',
                'Collyre (poussière)',
                'Médicaments personnels',
                'Trousse de premiers soins'
            ],
            vetements: [
                'Vêtements légers en coton (5-7 jours)',
                'Pull ou polaire (soirées fraîches)',
                'Veste imperméable (K-way)',
                'Maillot de bain',
                'Chaussures de randonnée',
                'Sandales/Tongs',
                'Chapeau/Casquette',
                'Lunettes de soleil',
                'Écharpe/Foulard (avril-octobre)'
            ],
            tech: [
                'Téléphone + chargeur',
                'Batterie externe',
                'Adaptateur électrique (type C & E)',
                'Appareil photo',
                'Lampe frontale/torche',
                'Piles de rechange'
            ],
            divers: [
                'Sac à dos (25-30L)',
                'Sac étanche',
                'Gourde réutilisable',
                'Cadenas pour bagages',
                'Couteau suisse (en soute)',
                'Serviette microfibre',
                'Sac de couchage léger (trek)',
                'Petite monnaie en Ariary',
                'Guide de voyage'
            ]
        };

        function formatPrice(ariary) {
            const euro = (ariary / EURO_RATE).toFixed(2);
            return {
                ariary: ariary.toLocaleString('fr-FR'),
                euro: euro
            };
        }

        async function fetchExchangeRate() {
            const rateDisplay = document.getElementById('rateDisplay');
            
            try {
                rateDisplay.textContent = 'Récupération du taux...';
                
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/EUR');
                
                if (!response.ok) {
                    throw new Error('API indisponible');
                }

                const data = await response.json();
                EURO_RATE = data.rates.MGA || 5192;
                lastUpdateTime = new Date();

                rateDisplay.innerHTML = `1 EUR = ${EURO_RATE.toFixed(2)} Ar <span style="font-size: 11px; opacity: 0.8;">(mis à jour à ${lastUpdateTime.toLocaleTimeString('fr-FR')})</span>`;
                
                // Rafraîchir l'affichage des prix avec le nouveau taux
                const activeCategory = document.querySelector('.category-btn.active');
                if (activeCategory) {
                    const searchTerm = document.getElementById('searchInput').value;
                    renderPrices(activeCategory.dataset.category, searchTerm);
                }

            } catch (error) {
                console.error('Erreur lors de la récupération du taux:', error);
                rateDisplay.innerHTML = `1 EUR = ${EURO_RATE} Ar <span style="font-size: 11px; opacity: 0.8;">(taux de secours - hors ligne)</span>`;
            }
        }

        function formatPrice(ariary) {
            const euro = (ariary / EURO_RATE).toFixed(2);
            return {
                ariary: ariary.toLocaleString('fr-FR'),
                euro: euro
            };
        }

        function renderPrices(category = 'all', searchTerm = '') {
            const priceListDiv = document.getElementById('priceList');
            priceListDiv.innerHTML = '';

            const categoriesToShow = category === 'all' 
                ? Object.keys(pricesData) 
                : [category];

            const categoryNames = {
                restaurant: '🍽️ Restaurant',
                street: '🥘 Street Food',
                marche: '🛒 Marché & Épicerie',
                transport: '🚕 Transport',
                boissons: '🥤 Boissons',
                vetements: '👕 Vêtements'
            };

            categoriesToShow.forEach(cat => {
                const items = pricesData[cat].filter(item => 
                    searchTerm === '' || 
                    item.name.toLowerCase().includes(searchTerm.toLowerCase())
                );

                if (items.length === 0) return;

                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'price-category';

                const titleDiv = document.createElement('div');
                titleDiv.className = 'category-title';
                titleDiv.textContent = categoryNames[cat];
                categoryDiv.appendChild(titleDiv);

                items.forEach(item => {
                    const priceItem = document.createElement('div');
                    priceItem.className = 'price-item';

                    const prices = formatPrice(item.ariary);

                    let badge = '';
                    if (item.tip === 'BON PLAN') {
                        badge = '<span class="tip-badge">BON PLAN</span>';
                    } else if (item.tip === 'ARNAQUE') {
                        badge = '<span class="warning-badge">ARNAQUE</span>';
                    }

                    priceItem.innerHTML = `
                        <div class="item-name">${item.name}${badge}</div>
                        <div class="item-price">
                            <div class="price-ariary">${prices.ariary} Ar</div>
                            <div class="price-euro">≈ ${prices.euro} €</div>
                        </div>
                    `;

                    categoryDiv.appendChild(priceItem);
                });

                priceListDiv.appendChild(categoryDiv);
            });

            if (priceListDiv.innerHTML === '') {
                priceListDiv.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">Aucun résultat</p>';
            }
        }

        function renderChecklist() {
            const checklistDiv = document.getElementById('checklistContent');
            checklistDiv.innerHTML = '';

            const sectionTitles = {
                documents: '📄 Documents',
                sante: '🏥 Santé & Pharmacie',
                vetements: '👕 Vêtements & Accessoires',
                tech: '🔌 Technologie',
                divers: '🎒 Divers'
            };

            Object.keys(checklistData).forEach(section => {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'checklist-section';

                const title = document.createElement('h3');
                title.textContent = sectionTitles[section];
                sectionDiv.appendChild(title);

                checklistData[section].forEach((item, index) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'checklist-item';
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.id = `${section}-${index}`;
                    
                    const label = document.createElement('label');
                    label.htmlFor = `${section}-${index}`;
                    label.textContent = item;
                    
                    checkbox.addEventListener('change', function() {
                        if (this.checked) {
                            itemDiv.classList.add('checked');
                        } else {
                            itemDiv.classList.remove('checked');
                        }
                    });
                    
                    itemDiv.appendChild(checkbox);
                    itemDiv.appendChild(label);
                    sectionDiv.appendChild(itemDiv);
                });

                checklistDiv.appendChild(sectionDiv);
            });
        }

        // Gestion des onglets
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                const tabId = this.dataset.tab;
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Gestion des catégories
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const category = this.dataset.category;
                const searchTerm = document.getElementById('searchInput').value;
                renderPrices(category, searchTerm);
            });
        });

        // Gestion de la recherche
        document.getElementById('searchInput').addEventListener('input', function() {
            const searchTerm = this.value;
            const activeCategory = document.querySelector('.category-btn.active').dataset.category;
            renderPrices(activeCategory, searchTerm);
        });

        // Affichage initial
        fetchExchangeRate(); // Récupérer le taux de change en temps réel
        renderPrices();
        renderChecklist();
    </script>
</body>
</html>

</div>
<script>
(function() {
  const btn = document.getElementById('dark-mode-toggle');
  if (!btn) return;
  function setMode(dark) {
    document.body.classList.toggle('dark-mode', dark);
    btn.textContent = dark ? '🌙' : '🌞';
    localStorage.setItem('darkModeGuide', dark ? '1' : '0');
  }
  btn.onclick = function() {
    setMode(!document.body.classList.contains('dark-mode'))
  };
  let fromLS = localStorage.getItem('darkModeGuide');
  if (fromLS === '1' || (fromLS === null && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
    setMode(true);
  } else {
    setMode(false);
  }
})();
if ('serviceWorker' in navigator) {
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('./serviceWorker-guide.js')
    .then(function(reg){console.log('SW enregistré')})
    .catch(function(err){console.log('Erreur SW:', err)});
  });
}
function updateConnectionStatus() {
  var statusDiv = document.getElementById('connection-status');
  if (!statusDiv) return;
  if (navigator.onLine) {
    statusDiv.className = 'connection-status online';
    statusDiv.innerHTML = "<span class='pulse'></span> En ligne";
  } else {
    statusDiv.className = 'connection-status offline';
    statusDiv.innerHTML = "<span class='pulse'></span> Hors ligne";
  }
}
window.addEventListener('online', updateConnectionStatus);
window.addEventListener('offline', updateConnectionStatus);
window.addEventListener('load', updateConnectionStatus);
</script>
</body>
</html>
